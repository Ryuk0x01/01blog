<!-- Create Post Card -->
<mat-card class="create-post-card">
  <mat-card-header class="card-header">
    <mat-card-title class="title">Create New Post</mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <form (ngSubmit)="createPost()" class="post-form">
      <div class="form-body">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Post Title</mat-label>
          <input matInput type="text" placeholder="Give your post a title..." [(ngModel)]="newPostTitle" name="title"
            [disabled]="creatingPost()">
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>What's on your mind?</mat-label>
          <textarea matInput rows="4" placeholder="Share your thoughts with the world..." [(ngModel)]="newPostContent"
            name="content" [disabled]="creatingPost()"></textarea>
        </mat-form-field>
      </div>

      <div class="media-upload-zone">
        <input type="file" #fileInput class="hidden-file-input" id="fileInput" (change)="onFileSelected($event)"
          accept="image/*,video/*" [disabled]="creatingPost()">

        <div class="upload-actions">
          <button mat-stroked-button type="button" (click)="fileInput.click()" [disabled]="creatingPost()"
            class="upload-btn">
            <mat-icon>add_photo_alternate</mat-icon>
            {{ selectedFile() ? 'Change Media' : 'Add Image or Video' }}
          </button>

          @if (selectedFile()) {
          <div class="file-info-badge">
            <mat-icon>attachment</mat-icon>
            <span class="file-name">{{ selectedFile()!.name }}</span>
            <span class="file-size">({{ (selectedFile()!.size / 1024 / 1024).toFixed(1) }}MB)</span>
            <button mat-icon-button (click)="selectedFile.set(null)" class="remove-file">
              <mat-icon>close</mat-icon>
            </button>
          </div>
          }
        </div>
      </div>

      <div class="form-footer">
        @if (errorMessage()) {
        <span class="error-text">
          <mat-icon>error_outline</mat-icon>
          {{ errorMessage() }}
        </span>
        }
        <button mat-flat-button color="primary" type="submit"
          [disabled]="creatingPost() || !newPostTitle() || !newPostContent()" class="publish-btn">
          <mat-icon>{{ creatingPost() ? 'hourglass_empty' : 'rocket_launch' }}</mat-icon>
          {{ creatingPost() ? 'Publishing...' : 'Publish Post' }}
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
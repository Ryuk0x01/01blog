<div class="comments-container">
    <button class="toggle-btn" (click)="toggleComments()">
        {{ showComments() ? 'Hide Comments' : 'Show Comments' }} ({{ comments().length }})
    </button>

    @if (showComments()) {
    <div class="comments-section">

        <!-- Post New Comment -->
        <div class="new-comment">
            <h4>Add a Comment</h4>

            <div class="comment-input-group">
                <textarea class="comment-input" [(ngModel)]="newCommentContent" placeholder="Write your comment here..."
                    rows="3"></textarea>

                <button class="submit-btn" (click)="postComment()" [disabled]="postingComment()">
                    {{ postingComment() ? 'Posting...' : 'Post Comment' }}
                </button>
            </div>

            @if (errorMessage()) {
            <p class="error-message">{{ errorMessage() }}</p>
            }
        </div>

        <!-- Loading -->
        @if (loadingComments()) {
        <div class="loading">
            Loading comments...
        </div>
        } @else {

        <!-- No comments -->
        @if (comments().length === 0) {
        <div class="no-comments">
            No comments yet. Be the first to comment!
        </div>
        } @else {

        <!-- Comments List -->
        <div class="comments-list">
            @for (comment of comments(); track comment.id) {
            <div class="comment-item">
                <div class="comment-header">
                    <strong class="comment-author">
                        {{ comment.authorUsername }}
                    </strong>
                    <small class="comment-date">
                        {{ comment.createdAt | date:'short' }}
                    </small>
                </div>

                <p class="comment-content">
                    {{ comment.content }}
                </p>

                <button class="delete-btn" (click)="deleteComment(comment.id)" title="Delete comment">
                    Delete
                </button>
            </div>
            }
        </div>

        }
        }

    </div>
    }
</div>
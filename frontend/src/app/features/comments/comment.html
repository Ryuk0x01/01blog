<div class="comments-container">

    @if (showComments()) {
    <div class="comments-section">

        <!-- Post New Comment -->
        <div class="new-comment">
            <div class="comment-input-group">
                <textarea class="comment-input" [(ngModel)]="newCommentContent" placeholder="Write a comment..."
                    rows="2"></textarea>

                <div class="input-actions">
                    <button mat-flat-button color="primary" class="submit-btn" (click)="postComment()"
                        [disabled]="postingComment()">
                        <mat-icon>{{ postingComment() ? 'hourglass_empty' : 'send' }}</mat-icon>
                        {{ postingComment() ? 'Posting...' : 'Post' }}
                    </button>
                </div>
            </div>

            @if (errorMessage()) {
            <div class="error-message">
                <mat-icon>error_outline</mat-icon>
                {{ errorMessage() }}
            </div>
            }
        </div>

        <!-- Loading -->
        @if (loadingComments()) {
        <div class="loading">
            <mat-spinner diameter="24"></mat-spinner>
            <span>Loading comments...</span>
        </div>
        } @else {

        <!-- No comments -->
        @if (comments().length === 0) {
        <div class="no-comments">
            <mat-icon>forum</mat-icon>
            <p>No comments yet</p>
            <span>Be the first to share your thoughts!</span>
        </div>
        } @else {

        <!-- Comments List -->
        <div class="comments-list">
            @for (comment of comments(); track comment.id) {
            <div class="comment-item">
                <div class="comment-avatar">
                    {{ comment.authorUsername.charAt(0).toUpperCase() }}
                </div>

                <div class="comment-body">
                    <div class="comment-header">
                        <strong class="comment-author">{{ comment.authorUsername }}</strong>
                        <span class="comment-date">{{ comment.createdAt | date:'mediumDate' }}</span>
                    </div>

                    <p class="comment-content">{{ comment.content }}</p>
                </div>

                <button mat-icon-button class="delete-btn" (click)="deleteComment(comment.id)" title="Delete comment">
                    <mat-icon>close</mat-icon>
                </button>
            </div>
            }
        </div>

        }
        }

    </div>
    }
</div>